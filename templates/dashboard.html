<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TARA | Trading Assistant</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/dashboard.css?v=16">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <canvas id="matrix-bg"></canvas>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-left">
                <img src="/static/tara-logo.png" alt="TARA" style="height: 50px; margin-right: 15px; vertical-align: middle;">
                <div style="display: inline-block; vertical-align: middle;">
                    <h1 style="margin: 0; display: inline-block;">TARA</h1>
                    <div class="about-icon" id="aboutIcon" title="About TARA">
                        <span style="font-size: 16px; cursor: help;">‚ÑπÔ∏è</span>
                    </div>
                    <div class="subtitle">0DTE Options Scalping Bot</div>
                </div>
            </div>
            <div style="display: flex; align-items: center; gap: 15px;">
                <label class="toggle-switch" title="Toggle Background">
                    <input type="checkbox" id="bgToggleSwitch" checked>
                    <span class="toggle-slider"></span>
                </label>
                <span id="botStatus" class="status-badge loading">INITIALIZING...</span>
            </div>
        </div>
        
        <!-- About Popup -->
        <div id="aboutPopup" class="about-popup" style="display: none;">
            <div class="about-popup-content">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3 style="margin: 0; color: #00d9ff;">About TARA</h3>
                    <button class="close-popup" id="closeAbout" style="background: none; border: none; color: #999; font-size: 24px; cursor: pointer;">&times;</button>
                </div>
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                    <div>
                        <div style="color: #00d9ff; font-weight: bold; margin-bottom: 8px; font-size: 12px;">üéØ WHAT IT DOES</div>
                        <ul style="color: #999; line-height: 1.6; margin: 0; padding-left: 18px; font-size: 11px; list-style: none;">
                            <li>üìä 0DTE/1DTE options scalping</li>
                            <li>üîç Pre-market scan at <span style="color: #00ff41;">9:30 AM EST</span></li>
                            <li>üéØ Top 3 tickers daily</li>
                            <li>‚ö° Quick scalp trades</li>
                        </ul>
                    </div>
                    <div>
                        <div style="color: #00d9ff; font-weight: bold; margin-bottom: 8px; font-size: 12px;">üìà KEY METRICS</div>
                        <ul style="color: #999; line-height: 1.6; margin: 0; padding-left: 18px; font-size: 11px; list-style: none;">
                            <li>‚úÖ Volume & gap analysis</li>
                            <li>üì∞ AI news sentiment</li>
                            <li>üíπ IV rank & options</li>
                            <li>üé≤ ATR volatility</li>
                        </ul>
                    </div>
                    <div>
                        <div style="color: #00d9ff; font-weight: bold; margin-bottom: 8px; font-size: 12px;">üí∞ RISK MANAGEMENT</div>
                        <ul style="color: #999; line-height: 1.6; margin: 0; padding-left: 18px; font-size: 11px; list-style: none;">
                            <li>üü¢ Profit: <span style="color: #00ff41;">15%</span></li>
                            <li>üî¥ Stop: <span style="color: #ff0055;">7%</span></li>
                            <li>üõ°Ô∏è Max 5 trades/day</li>
                            <li>‚öñÔ∏è Position sizing</li>
                        </ul>
                    </div>
                    <div>
                        <div style="color: #00d9ff; font-weight: bold; margin-bottom: 8px; font-size: 12px;">ü§ñ AUTOMATION</div>
                        <ul style="color: #999; line-height: 1.6; margin: 0; padding-left: 18px; font-size: 11px; list-style: none;">
                            <li>üîÑ Fully automated</li>
                            <li>üì± Discord alerts</li>
                            <li>üìä Real-time monitor</li>
                            <li>üéØ No manual work</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Control Buttons -->
        <div style="display: flex; gap: 15px; margin-bottom: 25px; justify-content: center;">
            <button id="pauseBtn" class="btn-control btn-warning">‚è∏Ô∏è PAUSE TRADING</button>
            <button id="resumeBtn" class="btn-control btn-success" style="display:none;">‚ñ∂Ô∏è RESUME TRADING</button>
            <button id="forceCloseBtn" class="btn-control btn-danger">üõë FORCE CLOSE</button>
            <button id="settingsBtn" class="btn-control btn-info">‚öôÔ∏è SETTINGS</button>
        </div>
        
        <!-- Portfolio Chart -->
        <div class="card" style="margin-bottom: 25px;">
            <div class="card-title">üìà PORTFOLIO</div>
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 20px; padding: 15px; background: rgba(0, 217, 255, 0.05); border-radius: 8px;">
                <div style="text-align: center;">
                    <div class="stat-label" style="margin-bottom: 8px; font-size: 11px;">PORTFOLIO VALUE</div>
                    <div class="stat-value" id="chartPortfolioValue" style="font-size: 1.4em; color: #00ff41; font-weight: 700;">$0.00</div>
                </div>
                <div style="text-align: center;">
                    <div class="stat-label" style="margin-bottom: 8px; font-size: 11px;">CHANGE</div>
                    <div class="stat-value" id="chartDailyPnl" style="font-size: 1.4em; font-weight: 700;">$0.00</div>
                </div>
                <div style="text-align: center;">
                    <div class="stat-label" style="margin-bottom: 8px; font-size: 11px;">RETURN %</div>
                    <div class="stat-value" id="chartTotalReturn" style="font-size: 1.4em; font-weight: 700;">0.00%</div>
                </div>
            </div>
            <div style="position: relative; height: 220px; margin-bottom: 15px;">
                <canvas id="portfolioChart"></canvas>
            </div>
            <div style="display: flex; gap: 8px; justify-content: center;">
                <button class="chart-btn active" data-range="1D">1D</button>
                <button class="chart-btn" data-range="1W">1W</button>
                <button class="chart-btn" data-range="1M">1M</button>
                <button class="chart-btn" data-range="3M">3M</button>
                <button class="chart-btn" data-range="ALL">ALL</button>
            </div>
        </div>
        
        <!-- Control Panel -->
        <div class="control-panel">
            <div class="market-status" id="marketStatus">
                <div class="status-label">MARKET STATUS</div>
                <div class="status-value">Loading...</div>
            </div>
            <div class="daily-limits" id="dailyLimits">
                <div class="limit-item">
                    <span>TRADES</span>
                    <span id="tradesCount">0/5</span>
                </div>
                <div class="limit-item">
                    <span>DAILY P/L</span>
                    <span id="dailyPnl">0.00%</span>
                </div>
            </div>
        </div>
        
        <!-- Stats Grid -->
        <div class="grid">
            <div class="card">
                <div class="card-title">ACCOUNT OVERVIEW</div>
                <div class="stat">
                    <span class="stat-label">Cash Available</span>
                    <span class="stat-value" id="cash">$0.00</span>
                </div>
                <div class="stat">
                    <span class="stat-label">Buying Power</span>
                    <span class="stat-value" id="buyingPower">$0.00</span>
                </div>
                <div class="stat">
                    <span class="stat-label">Portfolio Value</span>
                    <span class="stat-value" id="portfolioValue">$0.00</span>
                </div>
            </div>
            
            <div class="card">
                <div class="card-title">PERFORMANCE METRICS</div>
                <div class="stat">
                    <span class="stat-label">Total Trades</span>
                    <span class="stat-value" id="totalTrades">0</span>
                </div>
                <div class="stat">
                    <span class="stat-label">Win Rate</span>
                    <span class="stat-value" id="winRate">0%</span>
                </div>
                <div class="stat">
                    <span class="stat-label">Average P/L</span>
                    <span class="stat-value" id="avgPnl">0.00%</span>
                </div>
                <div class="stat">
                    <span class="stat-label">Total P/L</span>
                    <span class="stat-value" id="totalPnl">0.00%</span>
                </div>
            </div>
            
            <div class="card">
                <div class="card-title">üéØ ACTIVE TICKERS</div>
                <div style="max-height: 200px; overflow-y: auto;">
                    <div id="tickerInfo">
                        <div class="empty-state">AWAITING PRE-MARKET SCAN...</div>
                    </div>
                    <div id="activeTickersList" style="margin-top: 15px;"></div>
                </div>
            </div>
            <div class="card">
                <div class="card-title">ACTIVE POSITION</div>
                <div id="positionInfo" class="empty-state" style="max-height: 200px; overflow-y: auto;">NO POSITION DETECTED</div>
            </div>
        </div>

        <!-- Watchlist Manager -->
        <div class="card" style="margin-bottom: 25px;">
            <div class="card-title">WATCHLIST MANAGER</div>
            <div class="watchlist-controls">
                <input type="text" id="newTicker" placeholder="Enter ticker (e.g., SPY)" maxlength="5" class="ticker-input">
                <button id="addTickerBtn" class="btn btn-success">ADD TICKER</button>
            </div>
            <div id="watchlistContainer" class="watchlist-tags" style="max-height: 150px; overflow-y: auto;">
                <div class="empty-state">Loading watchlist...</div>
            </div>
        </div>
        
        <!-- Today's Trades -->
        <div class="card" style="margin-bottom: 25px;">
            <div class="card-title">TODAY'S TRADES</div>
            <div style="max-height: 300px; overflow-y: auto; overflow-x: auto;">
                <table class="trades-table" id="tradesTable">
                    <thead>
                        <tr>
                            <th>TIME</th>
                            <th>SYMBOL</th>
                            <th>TYPE</th>
                            <th>QTY</th>
                            <th>ENTRY</th>
                            <th>EXIT</th>
                            <th>P/L</th>
                            <th>REASON</th>
                        </tr>
                    </thead>
                    <tbody id="tradesBody">
                        <tr>
                            <td colspan="8" class="empty-state">NO TRADES EXECUTED TODAY</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- System Logs -->
        <div class="card">
            <div class="card-title">
                SYSTEM LOGS
                <div class="log-controls">
                    <input type="text" id="logSearch" placeholder="üîç Search logs..." class="log-search">
                    <select id="logFilter" class="log-filter">
                        <option value="all">All Levels</option>
                        <option value="INFO">‚ÑπÔ∏è Info</option>
                        <option value="WARNING">‚ö†Ô∏è Warning</option>
                        <option value="ERROR">‚ùå Error</option>
                        <option value="DEBUG">üîß Debug</option>
                    </select>
                    <button id="clearLogs" class="btn-mini">üóëÔ∏è Clear</button>
                    <button id="pauseLogs" class="btn-mini">‚è∏Ô∏è Pause</button>
                    <button id="downloadLogs" class="btn-mini">üíæ Download</button>
                </div>
            </div>
            <div class="logs-stats">
                <span class="log-stat">Total: <span id="totalLogs">0</span></span>
                <span class="log-stat log-stat-info">Info: <span id="infoCount">0</span></span>
                <span class="log-stat log-stat-warning">Warnings: <span id="warningCount">0</span></span>
                <span class="log-stat log-stat-error">Errors: <span id="errorCount">0</span></span>
            </div>
            <div class="logs-container" id="logsContainer">
                <div class="log-line loading">LOADING SYSTEM LOGS...</div>
            </div>
        </div>
        
        <div class="refresh-time">
            LAST UPDATE: <span id="lastUpdate">--:--:--</span>
        </div>
    </div>
    
    <!-- Settings Modal -->
    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚öôÔ∏è TARA Settings</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div class="settings-section">
                    <h3>Trading Parameters</h3>
                    <div class="setting-item">
                        <label>Profit Target (%)</label>
                        <input type="number" id="profitTarget" step="1" min="0" max="100">
                        <span class="setting-help">Exit when position reaches this profit percentage</span>
                    </div>
                    <div class="setting-item">
                        <label>Stop Loss (%)</label>
                        <input type="number" id="stopLoss" step="1" min="0" max="100">
                        <span class="setting-help">Exit when position hits this loss percentage</span>
                    </div>
                    <div class="setting-item">
                        <label>Risk Per Trade (%)</label>
                        <input type="number" id="riskPerTrade" step="0.1" min="0" max="10">
                        <span class="setting-help">Percentage of capital to risk per trade</span>
                    </div>
                    <div class="setting-item">
                        <label>Position Timeout (seconds)</label>
                        <input type="number" id="positionTimeout" step="1" min="60" max="3600">
                        <span class="setting-help">Auto-exit if position held longer than this</span>
                    </div>
                </div>
                
                <div class="settings-section">
                    <h3>Safety Limits</h3>
                    <div class="setting-item">
                        <label>Max Daily Loss (%)</label>
                        <input type="number" id="maxDailyLoss" step="1" min="0" max="50">
                        <span class="setting-help">Stop trading if daily loss exceeds this</span>
                    </div>
                    <div class="setting-item">
                        <label>Max Trades Per Day</label>
                        <input type="number" id="maxTrades" step="1" min="1" max="50">
                        <span class="setting-help">Maximum number of trades allowed per day</span>
                    </div>
                </div>
                
                <div class="settings-section">
                    <h3>Signal Detection</h3>
                    <div class="setting-item">
                        <label>RSI Call Minimum</label>
                        <input type="number" id="rsiCallMin" step="1" min="50" max="80">
                        <span class="setting-help">Minimum RSI for call signals</span>
                    </div>
                    <div class="setting-item">
                        <label>RSI Put Maximum</label>
                        <input type="number" id="rsiPutMax" step="1" min="20" max="50">
                        <span class="setting-help">Maximum RSI for put signals</span>
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button id="saveSettings" class="btn btn-success">SAVE CHANGES</button>
                    <button id="cancelSettings" class="btn btn-secondary">CANCEL</button>
                </div>
            </div>
        </div>
    </div>
    
    <script src="/static/matrix.js?v=2"></script>
    <script src="/static/dashboard.js?v=11"></script>
</body>
</html>
